# npm

## npm 이란

- Node Package Manager

- 다른 사람들이 만든 소스 코드들을 모아둔 저장소

- 남의 코드를 사용하여 프로그래밍 가능

- 이미 있는 기능을 다시 구현할 필요가 없어 효율적

- 오픈 소스 생태계를 구성중

- 패키지: npm에 업로드된 노드 모듈

- 모듈이 다른 모듈을 사용할 수 있듯 패키지도 다른 패키지를 사용할 수 있고 의존 관계라 부름

  
## package.json으로 패키지 관리

### package.json

- 현재 프로젝트에 대한 정보와 사용 중인 패키지에 대한 정보를 담은 파일

- 같은 패키지라도 버전별로 기능이 다를 수 있으므로 버전을 기록해두어야 함

- 노드 프로젝트 시작 전 package.json부터 만들고 시작함(npm init)

```bash
   npm init
   npm install express
```

| Key             | Value                                                        |
| --------------- | ------------------------------------------------------------ |
| name            | 프로젝트 이름으로, 가장 중요합니다. 중앙 저장소에 배포할 때 version과 함께 필수 항목입니다. url로 사용되고, 설치할 때 디렉토리 이름이 되기 때문에 url이나 디렉터리에서 쓸 수 없는 이름을 사용하면 안 됩니다. 또한, 이름에 node나 js가 들어가면 안 됩니다. name은 214자보다 짧아야 하며, 점(.)이나 밑줄(_)로 시작할 수 없습니다. 대문자를 포함해서는 안 되며, require() 함수의 인수로 사용되며 짧고 알기 쉬운 것으로 짓는 것이 좋습니다. |
| version         | 프로젝트 버전을 정의합니다. 3단계 버전(SemVar)을 사용하며, - 로 태그 이름을 적을 수 있습니다. |
| description     | 프로젝트 설명으로, 문자열로 기술합니다. npm search로 검색된 리스트에 표시되기 때문에 사람들이 패키지를 찾아내고 이해하는 데 도움이 됩니다. |
| keywords        | 프로젝트를 검색할 때 참조되는 키워드입니다. description과 마찬가지로 npm search로 검색된 리스트에 표시됩니다. |
| homepage        | 프로젝트 홈페이지 주소입니다. url 항목과는 다르며, url을 설정하면 예상치 못한 움직임을 하게 되므로 주의합니다. |
| author          | 프로젝트 작성자 정보로, 한 사람만을 지정합니다. JSON 형식으로 name, email, url 옵션을 포함합니다. |
| contributors    | 프로젝트에 참여한 공헌자 정보로, 여러 사람을 배열로 지정할 수 있습니다. |
| repository      | 프로젝트의 소스 코드를 저장한 저장소의 정보입니다.소스 코드에 참여하고자 하는 사람들에게 도움이 될 수 있습니다. 프로젝트의 홈페이지 url을 명시해서는 안 됩니다. |
| scripts         | 프로젝트에서 자주 실행해야 하는 명령어를 scripts로 작성해두면 npm 명령어로 실행 가능합니다. |
| config          | 소스 코드에서 config 필드에 있는 값을 환경 변수처럼 사용할 수 있습니다. |
| private         | 이 값을 true로 작성하면 중앙 저장소로 저장하지 않습니다.     |
| dependencies    | 프로젝트 의존성 관리를 위한 부분입니다. 이 프로젝트가 어떤 확장 모듈을 요구하는지 정리할 수 있습니다.일반적으로 package.json에서 가장 많은 정보가 입력되는 곳입니다. 애플리케이션을 설치할 때 이 내용을 참조하여 필요한 확장 모듈을 자동으로 설치합니다. 따라서 개발한 애플리케이션이 특정한 확장 모듈을 사용한다면 여기에 꼭 명시를 해주어야 합니다. 또한, npm install 명령은 여기에 포함된 모든 확장 모듈들을 설치하게 되어 있습니다. |
| devDependencies | 개발할 때만 의존하는 확장 모듈을 관리합니다.                 |
| engine          | 실행 가능한 노드 버전의 범위를 결정합니다.                   |

### node_modules

- npm install 시 node_modules 폴더 생성
- 내부에 설치한 패키지들이 들어 있음
- express 외에도 express와 의존 관계가 있는 패키지들이 모두 설치됨
- package-lock.json도 생성되어 패키지 간 의존 관계를 명확하게 표시함

### 여러 패키지 동시 설치하기
```bash
   npm install morgan express-session
```
 - 여러 패키지를 한번에 설치가능

### 개발용 패키지
```bash
   npm install -D eslit
```
 - 개발에서만 사용하는 패키지를 설치 가능

### npx

- Node Package eXecute의 약자

- 노드 패키지를 실행하는 명령어

-  npm 버전 5.2.0 이상부터는 npx를 사용할 수 있음

- 일회성으로 원하는 패키지를 npm 레지스트리에 접근해서 실행시키고 설치하는 실행도구

- 업데이트 필요 없이 npm 레지스트리에 올라가 있는 최신 버전을 실행시키는 도구

#### 언제 사용?
- npm run-script를 사용하지 않고 로컬에 설치된 패키지를 사용할 경우
```bash
  npx cowsay hello
```

- 일회성 명령으로 패키지를 실행할 경우

- 다른 node.js 버전으로 명령을 실행할 경우

  

## SemVer 버저닝

#### 노드 패키지의 버전은 SemVer(유의적 버저닝) 방식을 따름

- Major(주 버전), Minor(부 버전), Patch(수 버전)
- 노드에서는 배포를 할 때 항상 버전을 올려야 함
- Major는 하위 버전과 호환되지 않은 수정 사항이 생겼을 때 올림

- Minor는 하위 버전과 호환되는 수정 사항이 생겼을 때 올림

- Patch는 기능에 버그를 해결했을 때 올림

![image1.png](.\image\npm\image1.png)

#### 버전 앞에 기호를 붙여 의미를 더함

- ^1.1.1: 패키지 업데이트 시 minor 버전까지만 업데이트 됨(2.0.0버전은 안 됨)

- ~1.1.1: 패키지 업데이트 시 patch버전까지만 업데이트 됨(1.2.0버전은 안 됨)

- @latest는 최신 버전을 설치하라는 의미

- 실험적인 버전이 존재한다면 @next로 실험적인 버전 설치 가능(불안정함)

## npm의 다른 명령어

- npm search 검색어: npm 패키지를 검색할 수 있음(npmjs.com에서도 가능)
- npm update: package.json에 따라 패키지 업데이트
- npm info 패키지명: 패키지의 세부 정보 파악 가능

- npm whoami: 현재 사용자가 누구인지 알려줌
- npm prune: pacakge에 있는 모듈만 남기고 모두 삭제

- npm prune --production: package.json에서 dependcies에 있는 패키지만 남기고 삭제