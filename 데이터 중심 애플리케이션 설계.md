# 데이터 중심 애플리케이션 설계

### 신뢰할 수 있고 확장 가능하며 유지보수하기 쉬운 애플리케이션

- 과거와 달리 현재는 계산 중심이 아닌 데이터 중심적 애플리 케이션을 만듬
- 표준 구성 요소: ex) DB, 캐시, 검색 색인, 스트림, 일괄 처리 등등
- 이런 표준 구성에 대해 각 애플리케이션 마다 요구 사항이 다르기에 구축 시스템 또한 저마다의 특성을 지님(ex DB)

##### 데이터 시스템에 대한 생각

- 데이터 시스템이라는 포괄적인 용어로 묶어야 하는 이유
  - 데이터 저장과 처리를 위한 여러 도구들이 전통적인 분류에 딱 들어 맞지 않음(ex: 데이터베이스 처럼 지속성을 제공하는 아파치 카프카, 메시지 큐로 사용하는 데이터 스토어인 레디스 등 )
  - 단일 애플리케이션으로는 데이터 처리와 저장 모두를 만족 시킬 수 없고 다양한 도구들을 연결할 필요가 있음

##### 신뢰성

- 애플리케이션은 사용자가 기대한 기능을 수행한다
- 시스템은 사용자가 범한 실수나 예상치 못한 소프트웨어 사용법을 허용할 수 있다
- 시스템 성능은 예상된 부하와 데이터 양에서 필수적인 사용 사례를 충분히 만족한다.
- 시스템은 허가되지 않은 접근과 오남용을 방지한다.
- 위 모든 것이 올바르게 동작함을 의미하며 무언가 잘못되더라도 올바르게 동작함을 신뢰성 의미로 생각할 수 있음
- 결함: 잘못될 수 있는 일 -> 예측하고 대처할 수 있는 시스템을 내결함성 또는 탄력성을 지녔다 표현
- 내결함성을 지녔다고 해서 모든 종류의 결함을 견딜수 있다는 것이 아닌 특정 유형의 결함에 대해 내성을 지녔다고 이야기하는게 타당함
- 장애: 사용자에게 필요한 서비스를 제공하지 못하고 시스템 전체가 멈춘 경우 -> 이런 장애가 결함으로 발생하지 않도록 구조를 설계하는 것이 좋음
- 하드웨어 결함
  - 하드웨어 자체 결함으로 MTTF(하드디스크의 평균 장애 시간)은 약 10 ~ 50년으로 보고됨
  - 시스템 장애율을 줄이기 위해 각 하드웨어 구성요소에 중복을 추가함
  - But 데이터 양과 애플리케이션의 계산 요구가 늘어 남에 따라 많은 하드웨어가 사용되어 있고 이에 비례하는 하드웨어 결함율이 증가함
  - 소프트웨어 내결함성 기술을 통해 해당 문제를 해결함

- 소프트웨어 오류
  - 하드웨어의 경우 장비들 관의 오류가 약상관관계를 지님
  - But 소프트웨어 오류의 경우 예상하기 어렵고 오류간 큰 상관관계를 지님
    - 잘못된 특정 입력이 있을 떄 모든 애플리케이션 서버 인스턴스가 죽는 소프트웨어 버그 ex) 리눅스 커널의 버그로 인해 애플리케이션이 일제히 멈췄던 적이 있음
    - 한 구성 요소의 장애가 다른 구성 요소의 장애를 야기하고 차례차례 더 많은 결함이 발생하는 연쇄 장애

- 인적 오류
  - 인적 오류의 경우 전체 결함중 10~25%를 차지함
  - 이런 인적 오류를 줄이는 접근 방식
    - 오류의 가능성을 최소하는 방향으로 시스템을 설계하라.
    - 사람이 가장 많이 실수 하는 부분에서 사람의 실수로 장애가 발생할 수 있는 부분을 분리하라.
    - 단위 테스트부터 전체 시스템 통합 테스트까지 모든 수준에서 철저하게 테스트 수행하라.
    - 장애 발생의 영향을 최소화하기 위해 인적 오류를 빠르고 쉽게 복구할 수 있도록 하라.
    - 성능 지표와 오류율과 같은 상세하고 명확한 모니터링 대책을 마련하라.

##### 확장성

- 증가하는 부하에 대처하는 시스템 능력을 표현하는 용어
- X는 확장 가능하다 또는 Y는 확장 불가능하다를 의미보다는 시스템이 특정 방식으로 커지면 이에 대처하기 위한 선택은 무엇인가에 대한 질문을 고려한다는 의미
- 부하 기술하기
  - 현재 부하를 파악하는게 필요함
  - 부하 매개변수: 시스템 설계에 따라 달라지며 초당 요청 수, 데이터베이스 읽기 대 쓰기 비율 등등 사용함
  - 트위터 예시
    - 트위터 주요 동작은 트윗 작성(사용자가 팔로워에게 새로운 메시지 게시, 평균 초당 4.6k 요청, 피크 시 초당 12k)과 홈 타임라인(사용자가 팔로우한 사람의 작성 트윗을 봄, 초당 300k)
    - 문제상황: 개별 사용자가 인기 있는(팔로우가 많은) 사람을 팔로우 하고 인기 있는(팔로우가 많은) 사람이 개별 사용자에게 트윗 작성.

##### 유지보수성

##### 정리